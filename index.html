<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vizualizator Excel / Sheets</title>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <style>
    :root { --bg:#ffffff; --card:#ffffff; --text:#0b1220; --muted:#4b5563; --accent:#2563eb; }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;background:#f5f7fb;color:var(--text)}

    /* layout */
    .app{display:grid;grid-template-columns:280px 1fr;min-height:100vh}
    .drawer{background:#ffffff;border-right:1px solid rgba(0,0,0,.08);padding:16px;position:sticky;top:0;height:100vh;transition:transform .2s ease}
    .drawer-head{font-weight:700;margin-bottom:10px}
    .drawer-nav{display:flex;flex-direction:column;gap:8px}
    .drawer-controls{display:flex;gap:8px;flex-direction:column;margin-top:12px}
    .drawer-controls .icon-btn,.drawer-controls .btn{width:100%;text-align:left}
    .nav-link{appearance:none;border:1px solid rgba(0,0,0,.08);background:#fff;padding:10px 12px;border-radius:12px;text-align:left;cursor:pointer}
    .nav-link.active,.nav-link:hover{border-color:var(--accent);box-shadow:0 0 0 2px rgba(37,99,235,.14) inset}

    /* topbar cu căutarea centrată */
    .topbar{
      position:sticky;top:0;z-index:10;background:#ffffff;
      border-bottom:1px solid rgba(0,0,0,.08);
      display:grid;grid-template-columns:1fr auto 1fr;align-items:center;
      padding:10px 14px;gap:10px;
    }
    .left{justify-self:start;display:flex;align-items:center;gap:8px}
    .center{justify-self:center}
    .search input{padding:10px 14px;border:1px solid rgba(0,0,0,.12);border-radius:999px;width:min(42vw,520px)}

    .content{padding:12px}
    .view{display:none}
    .view.active{display:block}
    .subhead{padding:14px 16px;border-bottom:1px solid rgba(0,0,0,.08)}
    .wrap{max-width:1100px;margin:12px auto;padding:0}
    .card{background:var(--card);border:1px solid rgba(0,0,0,.08);border-radius:16px;box-shadow:0 6px 18px rgba(0,0,0,.08);overflow:hidden}
    .drop{border:2px dashed rgba(0,0,0,.16);border-radius:14px;margin:16px;display:grid;place-items:center;padding:28px;text-align:center;transition:.2s;background:#ffffff}
    .drop.dragover{border-color:var(--accent);background:rgba(37,99,235,.06)}
    .tabs{display:flex;gap:8px;overflow:auto;padding:10px 12px;border-bottom:1px solid rgba(0,0,0,.08);background:#ffffff}
    .tab{white-space:nowrap;border:1px solid rgba(0,0,0,.12);padding:8px 12px;border-radius:999px;background:#f8fafc;cursor:pointer}
    .tab.active{border-color:var(--accent);box-shadow:0 0 0 2px rgba(37,99,235,.18) inset}
    .out{padding:16px;overflow:auto;background:#ffffff}
    .out table{display:block;max-width:100%;overflow:auto}
    @media (max-width: 600px){ .search input{width:92vw} }

    table{width:100%;border-collapse:collapse}
    th,td{border:1px solid rgba(0,0,0,.12);padding:8px;vertical-align:top}
    th{background:#f3f4f6}
    .hit{outline:2px solid var(--accent); background:rgba(37,99,235,.12)}
    .status{font-size:12px;color:var(--muted);padding:8px 12px}

    .app.nav-collapsed{grid-template-columns:0 1fr}
    @media (max-width: 900px){
      .app{grid-template-columns:1fr}
      .drawer{position:fixed;left:0;top:0;bottom:0;width:280px;z-index:20;transform:translateX(-100%)}
      .drawer.open{transform:translateX(0)}
    }

    /* Dark mode */
    body.dark{ background:#0b1220; color:#e7ecf3; }
    body.dark .drawer, body.dark .topbar, body.dark .card, body.dark .drop, body.dark .tabs, body.dark .out{ background:#121a2b; border-color:rgba(255,255,255,.12); }
    body.dark .nav-link, body.dark .tab, body.dark .icon-btn, body.dark .btn, body.dark .search input{ background:#0f1726; border-color:rgba(255,255,255,.12); color:#e7ecf3; }
    body.dark th{ background:rgba(255,255,255,.06); }
    body.dark .drop.dragover{ background:rgba(77,163,255,.06); }
    body.dark .status{ color:#a9b3c4; }
    .icon-btn{appearance:none;border:1px solid rgba(0,0,0,.12);background:#fff;border-radius:10px;padding:8px 10px;cursor:pointer}
    .icon-btn:hover{border-color:var(--accent)}
    .btn{appearance:none;border:1px solid rgba(0,0,0,.12);color:var(--text);background:#ffffff;border-radius:12px;padding:10px 14px;font-weight:600;cursor:pointer}
    .btn:hover{border-color:var(--accent);box-shadow:0 0 0 3px rgba(37,99,235,.12)}
    input[type=url]{border:1px solid rgba(0,0,0,.12);border-radius:10px;padding:10px}
  </style>
</head>
<body>
  <div class="app">
    <aside class="drawer" id="drawer" aria-label="Meniu">
      <div class="drawer-head">Meniu</div>
      <nav class="drawer-nav">
        <button class="nav-link" data-section="home">Acasă</button>
        <hr>
        <button class="nav-link" data-section="s1">Chime S1–S52</button>
        <button class="nav-link" data-section="s2">Curse spre XAR1</button>
        <button class="nav-link" data-section="s3">Curse intermodale</button>
      </nav>

      <div class="drawer-controls">
        <label class="btn" for="file">Încarcă Excel</label>
        <input id="file" type="file" accept=".xlsx,.xls,.xlsb,.xlsm,.csv" hidden />
        <button id="saveHtml" class="btn" disabled>Salvează HTML</button>
        <button id="backBtn" class="icon-btn">Înapoi</button>
        <button id="themeBtn" class="icon-btn">Dark</button>

        <div style="margin-top:8px;font-size:12px;color:#64748b">Încarcă din Google Sheets (CSV public)</div>
        <input id="gsUrl" type="url" placeholder="Lipește link-ul foii sau linkul CSV public">
        <button id="loadGs" class="btn">Încarcă din Sheets</button>
      </div>

      <div id="status" class="status"></div>
    </aside>

    <header class="topbar">
      <div class="left">
        <button id="menuBtn" class="icon-btn" title="Meniu">≡</button>
        <button id="homeBtn" class="icon-btn" title="Acasă">⌂</button>
      </div>
      <div class="center">
        <div class="search">
          <input id="searchInput" type="search" placeholder="Caută în tabelul curent…">
        </div>
      </div>
      <div></div>
    </header>

    <main class="content">
      <section id="home" class="view active">
        <div class="wrap">
          <div class="card"><div class="subhead"><h2 style="margin:0">Bun venit</h2></div>
            <div class="out" style="padding:16px">Alege o secțiune din stânga și încarcă un fișier Excel/CSV sau un link Google Sheets (CSV public). Datele sunt procesate local, în browser.</div>
          </div>
        </div>
      </section>

      <section id="s1" class="view">
        <div class="wrap">
          <div class="card">
            <div class="subhead"><h2>Chime S1–S52</h2></div>
            <div id="drop-s1" class="drop"><p>Trage fișierul aici sau folosește „Încarcă Excel”.</p><p class="small">.xlsx / .xls / .xlsm / .csv</p></div>
            <div class="tabs" id="tabs-s1" hidden></div>
            <div id="out-s1" class="out"></div>
          </div>
        </div>
      </section>

      <section id="s2" class="view">
        <div class="wrap">
          <div class="card">
            <div class="subhead"><h2>Curse spre XAR1</h2></div>
            <div id="drop-s2" class="drop"><p>Trage fișierul aici sau folosește „Încarcă Excel”.</p><p class="small">.xlsx / .xls / .xlsm / .csv</p></div>
            <div class="tabs" id="tabs-s2" hidden></div>
            <div id="out-s2" class="out"></div>
          </div>
        </div>
      </section>

      <section id="s3" class="view">
        <div class="wrap">
          <div class="card">
            <div class="subhead"><h2>Curse intermodale</h2></div>
            <div id="drop-s3" class="drop"><p>Trage fișierul aici sau folosește „Încarcă Excel”.</p><p class="small">.xlsx / .xls / .xlsm / .csv</p></div>
            <div class="tabs" id="tabs-s3" hidden></div>
            <div id="out-s3" class="out"></div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Librărie + aplicație -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <script defer src="./app.js"></script>
</body>
</html>
